'''
Dictionary to connect the number of (stable) LHC Fill to
the CMS run numbers.
For now this is periodically done by hand.
Could be made smarter at some point.

A handy re-labeling function is also provided.
'''

fillRunDict = {
4034: [252299, 252300, 252303, 252306, 252308], 
4033: [252275],
4030: [252272, 252274], 
4028: [252186, 252187, 252188, 252189, 252190, 252191], 
4027: [252185],
4022: [252184],
4021: [252130, 252131, 252132, 252133, 252134, 252135, 252136, 252138, 252152, 252158, 252159, 252162, 252165, 252170, 252172, 252177, 252178, 252179], 
4020: [252126],
4019: [252116],
4018: [252104, 252105, 252107, 252110], 
4017: [252091, 252093, 252096, 252098, 252102], 
4016: [252081, 252082, 252088, 252089, 252090], 
4015: [252075],
4014: [252054, 252055, 252056, 252058, 252059, 252062, 252066, 252067, 252068, 252072], 
4013: [252045, 252049, 252050, 252053], 
4012: [252039],
4011: [251944, 251946, 251947, 251950, 251953, 251956, 251957, 251959, 251960, 251963, 251964, 251965, 251992, 251997, 252007, 252010, 252011, 252014, 252015, 252017, 252025, 252028, 252029, 252030, 252031, 252032, 252034, 252037], 
4010: [251929, 251930, 251931, 251934, 251937, 251938, 251939, 251941, 251942], 
4009: [251886, 251887, 251889, 251897, 251898, 251902, 251904, 251905, 251907, 251910, 251913, 251914, 251915, 251920, 251923, 251928], 
4008: [251883],
4007: [251868, 251869, 251871, 251875, 251876], 
4006: [251864],
4005: [251852, 251855], 
4004: [251802, 251805, 251808, 251824, 251831, 251836, 251843, 251845, 251849, 251850, 251851], 
4002: [251784, 251785, 251786, 251787, 251788, 251789, 251790, 251791, 251792, 251796], 
4001: [251781],
4000: [251762, 251763], 
3998: [251754, 251756, 251758], 
3997: [251729, 251730, 251732, 251736], 
3996: [251717, 251718, 251721], 
3995: [251694],
3994: [251683, 251687, 251688, 251689, 251691], 
3993: [251656, 251657, 251664, 251667, 251671], 
3992: [251636, 251638, 251640, 251642, 251643], 
3991: [251616, 251618], 
3990: [251607, 251610, 251612, 251615], 
3989: [251565, 251569, 251571, 251572, 251576, 251584, 251585, 251590, 251598, 251599, 251604, 251606], 
3988: [251559, 251560, 251561, 251562], 
3987: [251550, 251551, 251552, 251555], 
3986: [251548],
3985: [251544, 251546], 
3984: [251527, 251528, 251529], 
3983: [251521, 251522, 251523], 
3982: [251503, 251504], 
3981: [251491, 251493, 251496, 251497, 251498, 251499, 251500], 
3978: [251263, 251264, 251265, 251266, 251270, 251274, 251277, 251286, 251289, 251308, 251317, 251325, 251328, 251335, 251337, 251338, 251341, 251349, 251350, 251355, 251361, 251363, 251366, 251371, 251373, 251374, 251384, 251385, 251386, 251388, 251392, 251405, 251406, 251408, 251409, 251411, 251412, 251413, 251414, 251415, 251416, 251418, 251419, 251420, 251421, 251422, 251423, 251424, 251425, 251426, 251427, 251428, 251430, 251431, 251435], 
3977: [251258, 251259, 251261], 
3976: [251244, 251249, 251250, 251251, 251252], 
3975: [251171, 251172, 251173, 251175, 251179, 251181, 251193, 251194, 251196, 251198, 251200, 251201, 251202, 251204, 251206], 
3974: [251116, 251118, 251142, 251143, 251147, 251149, 251150, 251153, 251155, 251156, 251160, 251161, 251162, 251163, 251164, 251167, 251168, 251170], 
3973: [251109, 251112], 
3972: [251030, 251032, 251033, 251035, 251045, 251053, 251059, 251063, 251070, 251076, 251081, 251084, 251086, 251089, 251091, 251092, 251096, 251099],
3971: [251022, 251023, 251024, 251025, 251026, 251027, 251028], 
3970: [251002, 251003, 251004, 251008, 251011, 251012, 251013, 251015, 251017, 251018], 
3969: [251000, 251001], 
3968: [250943, 250946, 250951, 250953, 250958, 250959, 250962, 250965, 250967, 250974, 250985, 250989], 
3967: [250942],
3966: [250935, 250936, 250938, 250939], 
3965: [250930, 250931, 250932], 
3964: [250909, 250910, 250913, 250916, 250917], 
3963: [250907, 250908], 
3962: [250885, 250886, 250889, 250890, 250891, 250892, 250893, 250895, 250896, 250897, 250898, 250899, 250901, 250902], 
3961: [250873, 250876, 250877, 250882], 
3960: [250862, 250863, 250864, 250865, 250866, 250867, 250868, 250869, 250871], 
3959: [250832, 250837, 250839, 250840, 250842], 
3958: [250821, 250824, 250825, 250826, 250827, 250828, 250830], 
3957: [250809, 250810, 250811, 250812, 250813, 250814, 250815, 250817], 
3956: [250796, 250797, 250798, 250799, 250800, 250801, 250803, 250805], 
3955: [250792, 250794], 
3954: [250774, 250784, 250786, 250788, 250789, 250790], 
3953: [250751, 250755, 250761, 250762, 250764], 
3952: [250696, 250698, 250700], 
3951: [250678, 250679, 250680, 250681, 250682, 250683], 
3950: [250677],
3949: [250673, 250675, 250676], 
3948: [250665, 250666, 250670, 250672], 
3947: [250593, 250594, 250598, 250602, 250603, 250604, 250607, 250608, 250609, 250613, 250633, 250635, 250639, 250640, 250643, 250644, 250646, 250647, 250648, 250649, 250650, 250653, 250655, 250657, 250658, 250664], 
3946: [250566, 250575, 250576, 250577, 250580, 250587, 250590], 
3945: [250542, 250543, 250544, 250545, 250546, 250548, 250559, 250561, 250562, 250563], 
3944: [250531, 250532, 250533, 250535, 250536, 250538, 250539, 250540], 
3943: [250516, 250517, 250518, 250519, 250520, 250522, 250523, 250524, 250526, 250528, 250529, 250530], 
3942: [250514],
3941: [250499, 250500, 250504, 250505, 250508, 250511, 250512, 250513], 
3940: [250349, 250353, 250354, 250357, 250358, 250361, 250363, 250366, 250370, 250374, 250376, 250378, 250379, 250380, 250381, 250387, 250389, 250392, 250394, 250396, 250398, 250401, 250409, 250411, 250413, 250415, 250419, 250422, 250425, 250427, 250430, 250438, 250439, 250440, 250441, 250444, 250446, 250447, 250448, 250450, 250454, 250458, 250460, 250462, 250464, 250466, 250472, 250478, 250480, 250481, 250483, 250484, 250489, 250490, 250492], 
3939: [250228, 250234, 250238, 250240, 250242, 250244, 250245, 250249, 250252, 250254, 250255, 250257, 250259, 250263], 
3938: [250201, 250214, 250216, 250225], 
3937: [250130, 250131, 250134, 250136, 250139, 250143, 250144, 250147, 250151, 250153, 250154, 250157, 250158, 250161, 250162, 250163, 250166, 250167, 250168, 250169, 250170, 250171, 250173, 250175, 250177, 250179, 250181, 250185, 250187], 
3936: [250113, 250118, 250119, 250120, 250122, 250125], 
3935: [250026, 250027, 250028, 250029, 250030, 250031, 250032, 250033, 250034, 250036, 250037, 250038, 250039, 250040, 250041], 
3934: [250023, 250024, 250025], 
3933: [250019, 250020, 250021], 
3932: [249989, 249990, 249991, 249992, 249993, 249994, 249996, 249997, 249998, 249999, 250000, 250002, 250006, 250013, 250014, 250015, 250016, 250017, 250018], 
3931: [249968, 249969, 249970, 249971, 249972, 249973, 249974, 249975, 249977, 249978, 249980, 249981, 249982, 249983, 249984, 249985, 249986, 249987], 
3930: [249966],
3929: [249952, 249953, 249955, 249956, 249958, 249960, 249964, 249965], 
3928: [249913, 249914, 249915, 249916, 249917, 249918, 249919, 249920, 249921, 249922, 249923, 249924, 249925, 249926, 249927, 249928, 249929, 249930, 249931, 249932, 249933, 249934, 249935, 249936, 249937, 249938, 249939, 249940, 249941, 249942, 249943, 249944, 249945, 249947, 249948, 249949, 249950, 249951], 
3927: [249879, 249880, 249881, 249882, 249883, 249884, 249886, 249887, 249888, 249889, 249890, 249891, 249894, 249895, 249896, 249897, 249898, 249899, 249900, 249901, 249910, 249911, 249912], 
3926: [249849, 249851, 249852, 249853, 249854, 249855, 249856, 249857, 249858, 249859, 249860, 249861, 249862, 249863, 249864, 249865, 249866, 249867, 249868, 249869, 249870, 249871, 249872, 249873, 249874, 249875, 249876, 249877, 249878], 
3925: [249800, 249801, 249802, 249803, 249804, 249805, 249806, 249807, 249808, 249809, 249811, 249812, 249814, 249815, 249816, 249817, 249818, 249819, 249820, 249821, 249822, 249824, 249825, 249826, 249827, 249828, 249829, 249832, 249833, 249835, 249836, 249837, 249838, 249839, 249840, 249841, 249842, 249843, 249846, 249847, 249848], 
3924: [249795, 249796, 249797, 249798, 249799], 
3923: [249794],
3922: [249792, 249793], 
3921: [249790, 249791], 
3920: [249785, 249786, 249787, 249788, 249789], 
3919: [249775, 249776, 249777, 249778, 249779, 249780, 249781, 249782, 249783, 249784], 
3918: [249772, 249773, 249774], 
3917: [249771],
3916: [249764, 249765, 249766, 249768, 249769, 249770], 
3915: [249757, 249760, 249762, 249763], 
3914: [249739, 249740, 249741, 249742, 249743, 249744, 249746, 249747, 249748, 249750, 249751, 249752, 249754, 249755, 249756], 
3913: [249721, 249726, 249727, 249729, 249730, 249731, 249732, 249734, 249736, 249737, 249738], 
3912: [249639, 249641, 249651, 249667, 249694, 249697, 249701, 249702, 249703, 249704, 249705, 249707, 249708, 249711, 249712, 249713, 249718, 249719, 249720], 
3911: [249616, 249617, 249618, 249621, 249622, 249623, 249625, 249626, 249627, 249628, 249629, 249630, 249631, 249632, 249633, 249634, 249635, 249636], 
3910: [249604, 249605, 249606, 249607, 249608, 249610, 249612, 249613, 249614, 249615], 
3909: [249592, 249595, 249597, 249603], 
3908: [249587, 249588, 249589, 249590], 
3907: [249570, 249571, 249573, 249575, 249577, 249578, 249579, 249580, 249581], 
3906: [249566, 249567, 249568, 249569], 
3905: [249565],
3904: [249560, 249561, 249562, 249563], 
3903: [249545, 249546, 249549, 249552, 249553, 249554, 249555, 249557, 249559], 
3902: [249527, 249530, 249532, 249533, 249535, 249537, 249538, 249540, 249541, 249543, 249544], 
3901: [249524, 249526], 
3898: [249448],
3897: [249332, 249334, 249336, 249342, 249344, 249347, 249352, 249355, 249358, 249359, 249360, 249361, 249362, 249363, 249369, 249371, 249372, 249374, 249376, 249380, 249382, 249385], 
3896: [249315, 249317, 249319, 249322, 249324, 249325, 249327, 249329], 
3895: [249282, 249284, 249285, 249286, 249287, 249291, 249292, 249297, 249299, 249301, 249302, 249304, 249306, 249308], 
3894: [249254, 249256, 249262, 249264, 249269, 249271, 249272, 249276, 249280, 249281], 
3893: [249214, 249215, 249218, 249223, 249226, 249229, 249233, 249234, 249238, 249240, 249243, 249245, 249246, 249249], 
3892: [249166, 249171, 249192, 249193, 249194, 249198], 
3891: [249117],
3890: [249056, 249057, 249058, 249059, 249060, 249061, 249062, 249063, 249064, 249065, 249067, 249068, 249069, 249070, 249071, 249072, 249074, 249075, 249077, 249078, 249079, 249080, 249081, 249082, 249083, 249084, 249085, 249086, 249087, 249088, 249089, 249090, 249091, 249092, 249093, 249096, 249097, 249098, 249099, 249100, 249101, 249102, 249103, 249104, 249105, 249106, 249107, 249108, 249109, 249110, 249111, 249112, 249113, 249114, 249115], 
3889: [249054, 249055], 
3887: [249043, 249044, 249045, 249046, 249047, 249048, 249049, 249050, 249051], 
3886: [249036, 249037, 249038, 249039, 249040], 
3885: [249025, 249026, 249027, 249028, 249029, 249033, 249034], 
3884: [248961, 248964, 248966, 248967, 248968, 248969, 248975, 248978, 248980, 248982, 248984, 248985, 248986, 248989, 248990, 248992, 248994, 248998, 248999, 249002, 249004, 249011], 
3883: [248942, 248952, 248955, 248956, 248957, 248958, 248960], 
3882: [248874, 248875], 
3881: [248860, 248861, 248862, 248864, 248865, 248866, 248867, 248868, 248869, 248871, 248872, 248873], 
3880: [248855],
3879: [248854],
3877: [248842],
3876: [248835, 248836], 
3875: [248825, 248826, 248827, 248828, 248829, 248830, 248831, 248833], 
3873: [248824],
3866: [248749, 248753, 248756, 248758, 248761], 
3865: [248729, 248732, 248739, 248740, 248741, 248744], 
3864: [248689, 248690, 248691, 248692, 248693, 248694, 248696, 248697, 248698, 248699, 248700, 248701, 248702, 248703, 248704, 248705, 248706, 248707, 248708, 248710, 248712, 248713, 248715, 248716, 248719, 248720, 248722, 248725], 
3863: [248625, 248627, 248628, 248630, 248633, 248634, 248635, 248637, 248639, 248640, 248641, 248642, 248647, 248648, 248649, 248652, 248653, 248682, 248685, 248687, 248688], 
3862: [248589, 248590, 248593, 248594, 248596, 248597, 248598, 248599, 248604, 248605, 248606, 248607, 248608, 248609, 248610, 248611, 248612, 248613, 248615, 248617, 248619, 248620, 248621, 248623], 
3861: [248070, 248073, 248075, 248077, 248078, 248079, 248090, 248093, 248095, 248113, 248115, 248127, 248130, 248135, 248136, 248156, 248157, 248160, 248165, 248167, 248179, 248181, 248198, 248201, 248202, 248229, 248231, 248235, 248319, 248320, 248321, 248325, 248327, 248328, 248331, 248335, 248336, 248337, 248338, 248339, 248340, 248341, 248342, 248343, 248350, 248351, 248369, 248370, 248372, 248373, 248374, 248375, 248377, 248380, 248413, 248414, 248423, 248424, 248425, 248426, 248427, 248428, 248429, 248430, 248517, 248518, 248521, 248523, 248531, 248532, 248533, 248534, 248535, 248537, 248538, 248539, 248540, 248546, 248547, 248548, 248550, 248551, 248552, 248553, 248554, 248555, 248558, 248560, 248561, 248562, 248564, 248566, 248571, 248572, 248574, 248575, 248577, 248578, 248579, 248580, 248581, 248582, 248585], 
3860: [248063, 248065, 248066, 248068], 
3859: [248049, 248059, 248060, 248061, 248062], 
3858: [248025, 248026, 248027, 248028, 248029, 248030, 248031, 248032, 248033, 248035, 248036, 248037, 248038], 
3857: [247981, 247982, 247983, 247987, 247989, 247990, 247991, 247992, 247994, 247996, 247998, 248000, 248002, 248003, 248004, 248005, 248006, 248007, 248009], 
3856: [247939, 247941, 247944, 247949, 247951, 247952, 247953, 247957, 247958, 247959, 247960, 247962], 
3855: [247910, 247911, 247912, 247913, 247914, 247915, 247917, 247919, 247920, 247921, 247923, 247924, 247926, 247927, 247928, 247931, 247933, 247934], 
3854: [247827, 247828, 247829, 247842, 247848, 247851, 247853, 247854, 247855, 247856, 247860, 247863, 247864, 247866], 
3853: [247782, 247783, 247787, 247788, 247795, 247798], 
3852: [247724, 247733, 247734, 247735, 247737, 247740, 247741, 247743, 247744, 247745, 247747, 247748, 247750, 247753, 247754, 247755, 247765, 247766, 247767, 247768, 247770, 247771, 247772, 247775, 247777, 247778, 247780], 
3851: [247702, 247703, 247704, 247705, 247707, 247708, 247710, 247711, 247716, 247718, 247719, 247720], 
3850: [247685],
3849: [247652, 247659, 247661, 247667, 247669], 
3848: [247642, 247644, 247646, 247647, 247648], 
# 3847: [247623],
3846: [247607, 247609, 247610, 247611, 247612], 
3845: [247574, 247578, 247581, 247584, 247585, 247586, 247587, 247588], 
3844: [247551, 247554, 247562, 247563, 247564, 247565, 247568, 247571], 
3843: [247537, 247540, 247543, 247545, 247547, 247548, 247549], 
3842: [247533],
3841: [247519, 247521, 247523, 247524, 247525, 247528], 
3840: [247513, 247514], 
3839: [247502, 247503, 247504, 247506, 247507, 247509, 247510], 
3838: [247465, 247469, 247476, 247478, 247480, 247483, 247484, 247487, 247489, 247490, 247491], 
3837: [247416, 247423, 247424, 247425, 247430, 247433, 247435, 247438, 247440, 247441, 247442, 247443, 247444, 247445, 247449, 247456, 247461], 
3836: [247400, 247401, 247402, 247403, 247406, 247408], 
3835: [247377, 247379, 247380, 247381, 247382, 247383, 247384, 247385, 247386, 247387, 247388, 247389, 247394, 247395, 247397, 247398], 
3834: [247340, 247341, 247343, 247346, 247347, 247348, 247350, 247355, 247357], 
3833: [247302, 247303, 247305, 247306, 247307, 247309, 247310, 247313, 247317, 247318, 247319, 247320, 247323, 247324, 247326, 247328, 247333, 247334, 247335, 247336], 
3832: [247273, 247274, 247277, 247278], 
3831: [247271],
3829: [247231, 247232, 247233, 247234, 247235, 247236, 247237, 247238, 247240, 247241, 247243, 247244, 247245, 247246, 247247, 247248, 247250, 247251, 247252, 247253, 247255, 247256, 247259, 247261, 247262, 247263, 247265, 247266, 247267], 
3828: [247183, 247184, 247185, 247186, 247188, 247189, 247191, 247194, 247196], 
3826: [247149, 247150, 247151], 
3825: [247086, 247087, 247088, 247091, 247093, 247095, 247096, 247105, 247106, 247107, 247109, 247111, 247112, 247113, 247114, 247117, 247118, 247140, 247142, 247143], 
3824: [247068, 247069, 247070, 247073, 247076, 247077, 247078, 247079, 247081], 
3823: [247026, 247028, 247030, 247031, 247032, 247035, 247036, 247037, 247038, 247041, 247044, 247045, 247047, 247049, 247050, 247051, 247052, 247053, 247054], 
3822: [247005, 247006, 247008, 247009, 247012, 247013, 247014, 247015, 247016, 247017, 247018, 247019, 247020, 247021, 247024], 
3821: [246965, 246968, 246970, 246971, 246972, 246973, 246974, 246975, 246977, 246992, 246993, 246999, 247000, 247001, 247003], 
3820: [246951, 246953, 246954, 246956, 246957, 246958, 246959, 246960, 246961, 246962, 246963], 
3819: [246908, 246912, 246913, 246914, 246919, 246920, 246923, 246926, 246930, 246933, 246934, 246936],
}

def labelByFill(histo):
  '''
  Takes a TH1.
  Relabels the x-axis so that the Fill number appears.
  '''
  for ibin in range(histo.GetNbinsX()):
	irun = histo.GetXaxis().GetBinLabel(ibin+1)
# 	print 'Run:\t', irun
# 	if irun == 251143:
# 	  print '=='*30, 'fuck you!'
	if irun == '':  
	  continue
	for k, v in fillRunDict.items():
	  if int(irun) in v: 
		theifill = k
		break
	histo.GetXaxis().SetBinLabel(ibin+1, str(theifill))
  
  previousLabel = histo.GetXaxis().GetBinLabel(1)  
  for ibin in range(1, histo.GetNbinsX()):
	if histo.GetXaxis().GetBinLabel(ibin+1) == '':  continue
	if histo.GetXaxis().GetBinLabel(ibin+1) == previousLabel:
	  histo.GetXaxis().SetBinLabel(ibin+1, '')
	else:
	  previousLabel = histo.GetXaxis().GetBinLabel(ibin+1)


