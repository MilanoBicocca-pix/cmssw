<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="MiB Beam Spot : Milano Bicocca development and operations of CMS Beam Spot">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>MiB Beam Spot</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/MilanoBicocca-pix/cmssw">View on GitHub</a>

          <h1 id="project_title">MiB Beam Spot</h1>
          <h2 id="project_tagline">Milano Bicocca development and operations of CMS Beam Spot</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/MilanoBicocca-pix/cmssw/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/MilanoBicocca-pix/cmssw/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a id="what" class="anchor" href="#what" aria-hidden="true"><span class="octicon octicon-link"></span></a>What?</h3>

<p>This is meant to be the code sharepoint for Milano Bicocca group venture on the CMS Beam Spot development and operations</p>

<h3>
<a id="before-you-start" class="anchor" href="#before-you-start" aria-hidden="true"><span class="octicon octicon-link"></span></a>Before you start</h3>

<ul>
<li>you must have a GitHub account. Follow the FAQ <a href="http://cms-sw.github.io/faq.html">here</a>
if in trouble</li>
<li>make sure your machine is acknowledged by GitHub <a href="https://help.github.com/articles/generating-ssh-keys/">ssh key generation</a>
</li>
<li>join MilanoBicocca-pix common github (ask Riccardo)</li>
<li>take <a href="https://github.com/rmanzoni/tools/blob/master/mygitconfig">this gitconfig</a>, change user and email and put it into your ~/.gitconfig</li>
</ul>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>setup area</p>

<pre><code>cmsrel CMSSW_7_2_3
cd src
</code></pre>

<p>initialize a git repository</p>

<pre><code>git init
</code></pre>

<p>add the common Milano Bicocca remote github repository you will push your changes here (not into your personal github!) pull requests into the official cmssw github will be made from the common github </p>

<pre><code>git remote add mib git@github.com:MilanoBicocca-pix/cmssw.git
</code></pre>

<p>add also the official cmssw remote github, so that we can align from time to time</p>

<pre><code>git remote add official-cmssw git@github.com:cms-sw/cmssw.git
</code></pre>

<p>checkout just what you need, not the full burden</p>

<pre><code>git config core.sparsecheckout true
echo RecoVertex/BeamSpotProducer &gt;&gt; .git/info/sparse-checkout
git pull mib &lt;BRANCH&gt;
</code></pre>

<p>now you're up and running</p>

<h3>
<a id="very-minimal-how-to" class="anchor" href="#very-minimal-how-to" aria-hidden="true"><span class="octicon octicon-link"></span></a>Very minimal how to</h3>

<p>First, do your modifications, then the usual way to keep them on the record and to propagate them to everybody is</p>

<ol>
<li>git add FILE1 FILE2 ...</li>
<li>git commit -m "hey hey I saved the world today" </li>
<li>git push mib BRANCH</li>
</ol>

<p>now, if our private mib BRANCH reached the point it worths being put into the official CMSSW  </p>

<ol>
<li>(after 1., 2. and 3.) do a pull request <a href="http://cms-sw.github.io/tutorial.html#do-a-pull-request">http://cms-sw.github.io/tutorial.html#do-a-pull-request</a>
</li>
</ol>

<h3>
<a id="tricks-worth-noting" class="anchor" href="#tricks-worth-noting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tricks worth noting</h3>

<p>Check the differences between your HEAD and a given branch</p>

<pre><code>cd $CMSSW_BASE
cmsenv
git fetch REMOTE_NAME
find RecoVertex/BeamSpotProducer/ -wholename 'RecoVertex/BeamSpotProducer/*/*.*' -type f | git diff REMOTE_NAME/BRANCH_TO_COMPARE_AGAINST --
</code></pre>

<p>Check the differences between your HEAD and a given branch, but only display the names of the files that changed</p>

<pre><code>git diff --stat BRANCH_TO_COMPARE_AGAINST
</code></pre>

<h3>
<a id="more-extended-git-cheatsheet-in-light-of-our-scope" class="anchor" href="#more-extended-git-cheatsheet-in-light-of-our-scope" aria-hidden="true"><span class="octicon octicon-link"></span></a>More extended git cheatsheet (in light of our scope)</h3>

<p>set architecture for 75X</p>

<pre><code>setenv SCRAM_ARCH slc6_amd64_gcc491
</code></pre>

<p>create the release</p>

<pre><code>cmsrel CMSSW_7_5_X
cd CMSSW_7_5_X
cd src
</code></pre>

<p>initialise a git repo</p>

<pre><code>git init
</code></pre>

<p>tell git what remote github repos you’ll be interested in</p>

<pre><code>git remote add cms-official git@github.com:cms-sw/cmssw.git             # official CMSSW repository (you can push changes here)
git remote ass mib          git@github.com:MilanoBicocca-pix/cmssw.git  # MiB common repository (you have full access rights)
</code></pre>

<p>now you’ve got two remotes you can pull down from, cms-official and mib</p>

<p>now enable the sparse-checkout feature. You don’t want to have the whole wealth of CMSSW packages in your working directory, do you?</p>

<pre><code>git config core.sparsecheckout true
echo RecoVertex/BeamSpotProducer &gt;&gt; .git/info/sparse-checkout
</code></pre>

<p>now pull down the branch you want to work on from the remote mib repository</p>

<pre><code>git pull mib BRANCH
</code></pre>

<p>side note 1: “git pull mib BRANCH” is effectively equivalent to <code>git fetch mib ; git merge BRANCH</code>
side note 2: in case you already have something in your current branch, conflicts may happen. If you want to solve the conflicts, edit the conflicting files and commit them, then push. If you simply want to stop, cleanup and back off because you suspect you’re messing it up, then do <code>git merge —abort</code></p>

<p>now you can do all the changes you want</p>

<p>check if there’s any file you want to stage and, later commit</p>

<pre><code>git status
</code></pre>

<p>stage the files that will go into the next commit</p>

<pre><code>git add FILE1 FILE2
</code></pre>

<p>suppose theres one file that you modified but you don’t want to stage nor commit</p>

<pre><code>git checkout —- FILE
</code></pre>

<p>now you’re ready to commit, bear in mind that it’s a snapshot of the whole repo!</p>

<pre><code>git commit -m “my message”
</code></pre>

<p>if you want to start a new branch right from where you are now (first make sure your staging area is clean, aka <code>git status</code> should return clean)</p>

<pre><code>git checkout -b NEW_BRANCH # please note that NEW_BRANCH did not exist until now
</code></pre>

<p>to hop on and off a branch (as above, git status should return clean before you jump)</p>

<pre><code>git checkout BRANCH1
git checkout BRANCH2
</code></pre>

<p>suppose you’re on <code>BRANCH1</code> and you want to wipe it clean and align it to some other branch <code>BRANCH_TO_ALIGN_TO</code>. Beware, you’re gonna loose all your mods!</p>

<pre><code>git reset —hard BRANCH_TO_ALIGN_TO
</code></pre>

<p>now <code>git diff BRANCH_TO_ALIGN_TO</code> should return nothing, i.e. you forced <code>BRANCH1</code> to point to the exact commit <code>BRANCH_TO_ALIGN_TO</code> points to</p>

<p>if you want to display all the branches you have available locally</p>

<pre><code>git branch -a
</code></pre>

<p>you’ll notice that some of them look like <code>BRANCH</code> some others like <code>remotes/REMOTE/BRANCH</code>
the former are your local branches, whereas the latter are the branches that were available in the oven <code>REMOTE</code> 
frozen at the time of your last <code>git fetch/pull REMOTE</code> you did. These get regularly update every <code>git fetch/pull REMOTE</code></p>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>Riccardo Manzoni (<a href="https://github.com/rmanzoni" class="user-mention">@rmanzoni</a>)<br>
Sara Fiorendi (<a href="https://github.com/sarafiorendi" class="user-mention">@sarafiorendi</a>)<br>
Simone Gennai (<a href="https://github.com/gennai" class="user-mention">@gennai</a>)<br>
Mauro Dinardo (<a href="https://github.com/dinardo" class="user-mention">@dinardo</a>)  </p>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>manzoni AT cern DOT ch</p>

<h3>
<a id="about-github-pages" class="anchor" href="#about-github-pages" aria-hidden="true"><span class="octicon octicon-link"></span></a>About GitHub Pages</h3>

<p>This automatic page generator is the easiest way to create beautiful pages for all of your projects. Author your page content here using GitHub Flavored Markdown, select a template crafted by a designer, and publish. After your page is generated, you can check out the new branch:</p>

<pre><code>$ cd your_repo_root/repo_name
$ git fetch origin
$ git checkout gh-pages
</code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">MiB Beam Spot maintained by <a href="https://github.com/MilanoBicocca-pix">MilanoBicocca-pix</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
